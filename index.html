layout: base
~~~
<h1 id="tufte-css">Пакетная обработка заданий</h1>
<p class="subtitle">или как правильно<label for="sn-in-his-later-books" class="margin-toggle sidenote-number"></label></span><input type="checkbox" id="sn-in-his-later-books" class="margin-toggle"/><span class="sidenote">qsub any.job</span> использовать вычислительный кластер</p>
<div class="epigraph">
    <blockquote>
      <p>В очередь, сукины дети, в очередь!</p>
      <footer>Михаил Булгаков, «Собачье сердце»</footer>
    </blockquote>
</div>
<section>
  <p>
    <span class="newthought">При использовании кластера</span> двумя или более людьми возникает проблема распределения ресурсов. Конечно, можно \( f(x) \) договориться, кто когда и какие вычисления будет проводить, но это не самый надёжный способ решения этой проблемы. Для этих целей существует программное обеспечение, которое планирует и выполняет задачи с наиболее эффективным использованием вычислительных мощностей.
  </p>
  <p>
    На нашем кластере используется ПО Torque, по основам работы с которым мы сейчас пробежимся.
  </p>
</section>
<section>
  <h2>Начало работы с Torque</h2>
  <p>
    Для начала стоит понять, как работать с этой системой. Процесс состоит из 3 этапов:
  </p>
  <ol>
    <li><a href="#torque--create-job">создание файла с заданием</a></li>
    <li><a href="#torque--submit">постановка задания в очередь</a></li>
    <li><a href="#torque--run">выполнение задания</a></li>
  </ol>
  <p>
    Остановимся подробнее на каждом шаге.
  </p>
  <h3 id=torque--create-job>Создание задания для Torque</h3>
  <p>Файл с заданием представляет из себя скрипт и состоит из двух частей: описания запрашиваемых ресурсов и запуска программы с расчётом. Рассмотрим его структуру на конкретном примере:</p>
  ```bash
#PBS -S /bin/bash
#PBS -l nodes=1:ppn=1,mem=1g
#PBS -q batch
#PBS -m abe
#PBS -V

cd
./amazing_script.py > result.dat
  ```
  
  <h3 id=torque--submit>Постановка задания в очередь</h3>
  <p>
  Для постановки задания в очередь требуется выполнить всего одну команду:
  </p>
  ```bash
qsub first.job
  ```
  <p>
  После выполнения этой команды на консоль будет выведен номер задания, под которым оно зарегистрировано в очереди.
  </p>

  <h3 id=torque--run>Выполнение задания</h3>
  <p>
  За состоянием задания после его постановки в очередь можно следить при помощи `qstat`.
  </p>
</section>